---
phase: 08-batch-operations
plan: 02
type: execute
---

<objective>
Add multi-select UI to search results and batch download button that uses the new batch endpoint.

Purpose: Complete the batch operations feature by enabling users to select multiple results and download them all at once.
Output: Working multi-select checkboxes in search results with batch download button that provides clear feedback on success/failures.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior summaries
@.planning/phases/08-batch-operations/08-01-SUMMARY.md
@.planning/phases/07-mam-series-detection/07-02-SUMMARY.md

# Key files
@frontend/src/components/search/SearchResults.tsx
@frontend/src/components/search/SearchResultListItem.tsx
@frontend/src/components/search/SeriesGroup.tsx
@frontend/src/stores/useDownloadStore.ts
@frontend/src/api/downloads.ts

**Tech stack available:** React, Zustand stores, TypeScript, Tailwind CSS
**Established patterns:**
- Component-based UI with props interfaces
- Zustand stores for state management
- API client abstraction with error handling
- Notification store for user feedback

**Constraining decisions:**
- Phase 5: Frontend polls for download status every 3 seconds
- Phase 7: Series data is structured array (SeriesInfo[])
- Phase 7.1: Download requests send series name only (not with number)

**Issues being addressed:** None - this is a planned enhancement
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add batch download API client</name>
  <files>frontend/src/api/downloads.ts, frontend/src/types/download.ts</files>
  <action>Add BatchCreateDownloadRequest interface extending CreateDownloadRequest array. Add BatchCreateDownloadResponse interface with successful (Download[]) and failed (BatchDownloadError[] with index, request, error fields) arrays. Add downloadsApi.createBatch(downloads: BatchCreateDownloadRequest) method calling POST /api/downloads/batch. Return the BatchCreateDownloadResponse. Follow existing client patterns with APIClientError wrapping.</action>
  <verify>npm run build succeeds, new types exported from types/download.ts</verify>
  <done>Batch API method exists, types defined, follows project conventions</done>
</task>

<task type="auto">
  <name>Task 2: Add multi-select state and batch action to download store</name>
  <files>frontend/src/stores/useDownloadStore.ts</files>
  <action>Add createBatchDownload action that accepts CreateDownloadRequest[]. Call downloadsApi.createBatch(). On success, add all successful downloads to store, show notification with count (e.g., "5 downloads started successfully"). If any failed, show warning notification with failure count (e.g., "2 downloads failed - see details"). Return { successful: Download[], failed: BatchDownloadError[] }. Start polling if not already polling.</action>
  <verify>Store compiles without TypeScript errors</verify>
  <done>Batch action exists, handles partial success, provides clear notifications</done>
</task>

<task type="auto">
  <name>Task 3: Add multi-select UI to SearchResults</name>
  <files>frontend/src/components/search/SearchResults.tsx, frontend/src/components/search/SearchResultListItem.tsx, frontend/src/components/search/SeriesGroup.tsx</files>
  <action>In SearchResults, add selectedIds Set state (useState&lt;Set&lt;string&gt;&gt;). Add batch mode toggle button (top-right, "Select Multiple"). When batch mode active: (1) Show checkboxes in SearchResultListItem (pass selected prop and onToggleSelect callback), (2) Show floating batch action bar at bottom with "X selected" count and "Download Selected" button. When Download Selected clicked, map selectedIds to CreateDownloadRequest[] (extract from results), call createBatchDownload, clear selection after. In SeriesGroup, pass batch mode and selection handlers down to child SearchResultListItem components. Add indeterminate checkbox state for series groups (some children selected). Use Tailwind for floating action bar (fixed bottom, shadow, slide-up animation).</action>
  <verify>npm run dev starts, no console errors, UI renders properly with batch toggle</verify>
  <done>Multi-select mode works, checkboxes appear, batch button functional, series groups support selection, floating action bar displays correctly</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without TypeScript errors
- [ ] `npm run dev` starts development server successfully
- [ ] Multi-select toggle appears in SearchResults
- [ ] Checkboxes appear when batch mode enabled
- [ ] Floating action bar shows selected count
- [ ] Batch download button triggers batch API call
- [ ] Notifications show success/failure counts
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript compilation errors
- Multi-select UI follows existing design patterns
- Batch download provides clear feedback on partial success
- Series groups support batch selection
- Phase 8 complete - batch operations fully functional
</success_criteria>

<output>
After completion, create `.planning/phases/08-batch-operations/08-02-SUMMARY.md`:

# Phase 8 Plan 2: Frontend Batch UI Summary

**[Substantive one-liner - what shipped]**

## Accomplishments

- Added batch API client with partial success handling
- Implemented multi-select state in download store
- Created checkbox selection UI with floating action bar
- Integrated batch download with clear success/failure notifications

## Files Created/Modified

- `frontend/src/api/downloads.ts` - Batch API method
- `frontend/src/types/download.ts` - Batch types
- `frontend/src/stores/useDownloadStore.ts` - Batch action
- `frontend/src/components/search/SearchResults.tsx` - Multi-select state and batch UI
- `frontend/src/components/search/SearchResultListItem.tsx` - Checkbox rendering
- `frontend/src/components/search/SeriesGroup.tsx` - Series batch selection

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

Phase 8 complete. Ready for Phase 9 (Series Number Organization).
</output>
