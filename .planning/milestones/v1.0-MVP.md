# Milestone v1.0: MVP

**Status:** ✅ SHIPPED 2026-01-07
**Phases:** 1-6 (plus 1.1 inserted)
**Total Plans:** 8

## Overview

Build complete audiobook automation from torrent discovery to organized files. Start with qBittorrent integration for torrent submission, add monitoring for download tracking, implement configurable folder organization, and connect frontend for real-time status updates. Each phase delivers a testable capability, culminating in end-to-end workflow validation.

## Phases

### Phase 1: qBittorrent Integration

**Goal**: Authenticate with qBittorrent Web API and submit torrents from MAM search results
**Depends on**: Nothing (first phase)
**Plans**: 2 plans

Plans:
- [x] 01-01: Torrent file upload and category support
- [x] 01-02: Integration testing and error handling

**Details:**
Connected to qBittorrent Web API with cookie-based authentication. Implemented torrent file upload with multipart/form-data, hash retrieval via timestamp-sorted query, MAM authenticated downloads, and category support. Added comprehensive error handling with retry logic and user-friendly messages.

### Phase 1.1: qBittorrent Connection Testing (INSERTED)

**Goal**: Add backend test endpoint and frontend UI to verify qBittorrent connectivity and authentication
**Depends on**: Phase 1
**Addresses**: ISS-001 (discovered during Phase 1 integration testing)
**Plans**: 1 plan

Plans:
- [x] 01.1-01: Diagnostic endpoint and connection test UI

**Details:**
Urgent insertion to address ISS-001. During Phase 1 testing, qBittorrent authentication issues were encountered. A frontend connection test button helps users diagnose connectivity and authentication problems before attempting downloads. This phase added a dedicated test endpoint and UI component for troubleshooting qBittorrent configuration.

### Phase 2: Download Monitoring

**Goal**: Background monitor that polls qBittorrent for download progress and detects completion
**Depends on**: Phase 1
**Plans**: 1 plan

Plans:
- [x] 02-01: Monitor refinement with resilience and remote path support

**Details:**
Implemented background monitor with 3-second polling interval. Fixed context misuse for organization goroutines (now use parent context with 5-minute timeout). Added resilience to qBittorrent unavailability - monitor continues when all downloads fail. Improved state transition logging to reduce noise. Added remote path translation support for Docker/network deployments.

### Phase 3: Configuration System

**Goal**: User-configurable folder structure templates and destination paths
**Depends on**: Phase 2
**Plans**: 1 plan

Plans:
- [x] 03-01: Template validation and path preview

**Details:**
Created configuration system with template validation (only allows valid placeholders: {author}, {series}, {title}). Implemented real-time path preview with 500ms debounce showing example output as user types. Added inline validation errors to prevent user mistakes proactively. Fixed directory separator preservation in preview during checkpoint.

### Phase 4: File Organization Engine

**Goal**: Automated folder creation and file copying based on configuration templates
**Depends on**: Phase 3
**Plans**: 1 plan

Plans:
- [x] 04-01: Organization testing and validation

**Details:**
Refactored organization service to use interfaces for testability (qbittorrentClient, configService). Created comprehensive test suite with 11 test cases covering all scenarios. Added pre-organization validation: source file existence, readability, disk space checking with 10% buffer. Implemented partial failure recovery with automatic cleanup for copy operations. Enhanced error messages with full context.

### Phase 5: Frontend Integration

**Goal**: Real-time UI updates showing download status and organization progress
**Depends on**: Phase 4
**Plans**: 1 plan

Plans:
- [x] 05-01: Frontend integration verification and UX enhancements

**Details:**
Established Vitest testing framework with 22 comprehensive test cases covering DownloadStore polling, actions, error handling, and computed getters. Enhanced organization UX with informative messages, indeterminate progress bar, clipboard copy button with feedback, and retry button for failed attempts. Implemented configurable auto-organization toggle (defaults to enabled) with backend monitor checking config.

### Phase 6: End-to-End Testing

**Goal**: Complete workflow verification from MAM search through organized files
**Depends on**: Phase 5
**Plans**: 1 plan

Plans:
- [x] 06-01: Backend handler and monitor tests with E2E manual test scenarios

**Details:**
Created comprehensive backend handler tests covering all HTTP endpoints (CreateDownload, ListDownloads, CancelDownload, TestQBittorrentConnection, Config operations) with mock services. Added monitor service concurrency tests validating lifecycle, progress tracking, completion detection, auto-organization, resilience, and context cancellation. Zero race conditions detected. Created manual E2E documentation with 7 production-ready test scenarios.

---

## Milestone Summary

**Decimal Phases:**
- Phase 1.1: qBittorrent Connection Testing (inserted after Phase 1 to address ISS-001 discovered during integration testing)

**Key Decisions:**

| Decision | Rationale | Outcome |
|----------|-----------|---------|
| MAM authenticated downloads | MAM URLs trigger torrent file download before qBittorrent upload | ✓ Good - Required for private tracker authentication |
| Category support | Categories passed through to qBittorrent for organization | ✓ Good - Flexible torrent organization |
| Hash retrieval via timestamp | Query qBittorrent API sorted by added_on timestamp | ✓ Good - Reliable for all torrent sources |
| Retry strategy | Max 3 attempts with 500ms delay for torrent info query | ✓ Good - Handles qBittorrent processing delay |
| Context timeout for organization | 5-minute timeout for large file operations | ✓ Good - Prevents indefinite hanging during shutdown |
| Monitor resilience | Continue monitoring when all downloads fail | ✓ Good - Handles qBittorrent unavailability gracefully |
| Path mapping for remote deployments | Single mount point config prepended to qBittorrent paths | ✓ Good - Supports Docker and network shares |
| Template validation approach | Sanitize individual variables before template parsing | ✓ Good - Preserves directory structure while cleaning filenames |
| Preview debounce timing | 500ms debounce for preview API calls | ✓ Good - Balances responsiveness with server load |
| Copy operation strategy | All-or-nothing with automatic cleanup on failure | ✓ Good - Prevents partial copies |
| Move operation strategy | Partial success acceptable (atomic per file) | ✓ Good - Already moved files stay moved |
| Disk space checking | 10% buffer added to required space | ✓ Good - Accounts for filesystem overhead |
| Interface-based testing | Refactored OrganizationService for dependency injection | ✓ Good - Enables comprehensive mocking |
| Handler test strategy | HTTP layer only, mock all service dependencies | ✓ Good - Isolates HTTP concerns from business logic |
| Concurrency test approach | Channels/synchronization primitives instead of time.Sleep | ✓ Good - Creates deterministic, non-flaky tests |
| Race detection requirement | All concurrency code must pass go test -race | ✓ Good - Catches data races early |

**Issues Resolved:**
- ISS-001: qBittorrent connection diagnostics (resolved in Phase 1.1)

**Issues Deferred:**
None

**Technical Debt Incurred:**
- Limited test coverage on non-critical paths (qbittorrent client, search providers) - acceptable for v1.0, can expand in future
- Manual E2E testing required before deployment - automation can be added in future versions

---

_For current project status, see .planning/ROADMAP.md_
